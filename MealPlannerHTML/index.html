<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Planner Tygodniowy â€“ JadÅ‚ospis Dynamiczny</title>
<link rel="stylesheet" href="styles.css">
</head>
<body>

<!-- Firebase Login UI (hidden by default) -->
<div id="loginScreen" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); z-index: 10000; align-items: center; justify-content: center;">
  <div style="background: white; padding: 40px; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); text-align: center; max-width: 400px;">
    <h1 style="margin: 0 0 10px 0; color: #1d1d1f;">ğŸ”— Synchronizacja danych</h1>
    <p style="color: #666; margin-bottom: 30px;">Zaloguj siÄ™, aby zsynchronizowaÄ‡ dane miÄ™dzy urzÄ…dzeniami (Mac, iPhone, etc.)</p>
    <button id="googleSignInBtn" style="width: 100%; padding: 15px; background: white; border: 2px solid #ddd; border-radius: 10px; font-size: 16px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 10px; transition: all 0.3s;" onmouseover="this.style.boxShadow='0 4px 12px rgba(0,0,0,0.15)'" onmouseout="this.style.boxShadow='none'">
      <svg width="20" height="20" viewBox="0 0 48 48"><path fill="#EA4335" d="M24 9.5c3.54 0 6.71 1.22 9.21 3.6l6.85-6.85C35.9 2.38 30.47 0 24 0 14.62 0 6.51 5.38 2.56 13.22l7.98 6.19C12.43 13.72 17.74 9.5 24 9.5z"/><path fill="#4285F4" d="M46.98 24.55c0-1.57-.15-3.09-.38-4.55H24v9.02h12.94c-.58 2.96-2.26 5.48-4.78 7.18l7.73 6c4.51-4.18 7.09-10.36 7.09-17.65z"/><path fill="#FBBC05" d="M10.53 28.59c-.48-1.45-.76-2.99-.76-4.59s.27-3.14.76-4.59l-7.98-6.19C.92 16.46 0 20.12 0 24c0 3.88.92 7.54 2.56 10.78l7.97-6.19z"/><path fill="#34A853" d="M24 48c6.48 0 11.93-2.13 15.89-5.81l-7.73-6c-2.15 1.45-4.92 2.3-8.16 2.3-6.26 0-11.57-4.22-13.47-9.91l-7.98 6.19C6.51 42.62 14.62 48 24 48z"/></svg>
      Zaloguj przez Google
    </button>
    <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #eee;">
      <button id="cancelLoginBtn" style="background: none; border: none; color: #666; cursor: pointer; font-size: 14px;">âœ• Anuluj</button>
    </div>
  </div>
</div>

<div class="container">
  <h1>ğŸ½ï¸ Planner Dietetyczny</h1>
  <p class="intro">Wybierz dania na kaÅ¼dy dzieÅ„ tygodnia dla <span class="person-michalina"><span class="person-michalina-name">Michalina</span></span> i <span class="person-marcin"><span class="person-marcin-name">Marcin</span></span>.<br>
  Po wyborze wszystkich posiÅ‚kÃ³w, wygeneruj jadÅ‚ospis i automatycznÄ… listÄ™ zakupÃ³w!</p>
  
  <div class="info-box">
    <h3 style="margin-top: 0; color: #2196f3;">ğŸ“Š Cel kaloryczny dzienny</h3>
    <div style="display: flex; gap: 20px; flex-wrap: wrap; margin-top: 15px;">
      <div style="flex: 1; min-width: 200px;">
        <label style="display: block; margin-bottom: 8px;"><strong class="person-michalina"><span class="person-michalina-name">Michalina</span>:</strong></label>
        <select id="caloriesMichalina" onchange="updateCalories()" style="width: 100%; padding: 8px; border: 2px solid #e91e63; border-radius: 5px; font-size: 14px;">
          <option value="1000">1000 kcal</option>
          <option value="1300" selected>1300 kcal</option>
          <option value="1500">1500 kcal</option>
          <option value="1800">1800 kcal</option>
          <option value="2000">2000 kcal</option>
          <option value="2500">2500 kcal</option>
        </select>
      </div>
      <div style="flex: 1; min-width: 200px;">
        <label style="display: block; margin-bottom: 8px;"><strong class="person-marcin"><span class="person-marcin-name">Marcin</span>:</strong></label>
        <select id="caloriesMarcin" onchange="updateCalories()" style="width: 100%; padding: 8px; border: 2px solid #2196f3; border-radius: 5px; font-size: 14px;">
          <option value="1500">1500 kcal</option>
          <option value="2000" selected>2000 kcal</option>
          <option value="2500">2500 kcal</option>
          <option value="3000">3000 kcal</option>
        </select>
      </div>
    </div>
    <small style="color: #666; display: block; margin-top: 10px;">ğŸ’¡ Gramatury skÅ‚adnikÃ³w bÄ™dÄ… automatycznie dostosowane do wybranego celu</small>
  </div>
  
  <div style="background: #f0f7ff; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #236be8;">
    <h3 style="margin-top: 0; color: #236be8;">ğŸ’Š Suplementacja</h3>
    <p style="margin: 5px 0;"><strong class="person-michalina"><span class="person-michalina-name">Michalina</span>:</strong> Witamina D3+K2 (2000IU), Omega-3, Multiwitamina/probiotyk, Izolat biaÅ‚ka (w razie braku biaÅ‚ka w diecie)</p>
    <p style="margin: 5px 0;"><strong class="person-marcin"><span class="person-marcin-name">Marcin</span>:</strong> Witamina D3 (2000IU), Omega-3, Magnez, Izolat biaÅ‚ka (po biegu)</p>
    <small style="color: #666;">* Suplementacja po konsultacji z lekarzem</small>
  </div>

  <div class="tabs">
    <button class="tab active" onclick="switchTab('planner')">ğŸ“… Planner</button>
    <button class="tab" onclick="switchTab('activity')">ğŸƒâ€â™‚ï¸ AktywnoÅ›Ä‡</button>
    <button class="tab" onclick="switchTab('fridge')">ğŸ§Š LodÃ³wka</button>
    <button class="tab" onclick="switchTab('training')">ğŸ’ª Trening</button>
    <button class="tab" onclick="switchTab('stats')">ğŸ“Š Statystyki & Garmin</button>
    <button class="tab" onclick="switchTab('manage')">âš™ï¸ ZarzÄ…dzaj danymi</button>
  </div>

  <div id="planner-tab" class="tab-content active">
    <div class="meal-count-selector">
      <label>Liczba posiÅ‚kÃ³w dziennie:</label>
      <label><input type="radio" name="mealCount" value="3" checked onchange="updateMealCount()"> 3 posiÅ‚ki (Å›niadanie, obiad, kolacja)</label>
      <label><input type="radio" name="mealCount" value="4" onchange="updateMealCount()"> 4 posiÅ‚ki (+ podwieczorek)</label>
    </div>
    
    <div class="action-buttons">
      <button class="btn-action btn-randomize" onclick="randomizujPlan()">ğŸ² Randomizuj caÅ‚y tydzieÅ„</button>
      <button class="btn-action btn-reset" onclick="resetujPlan()">ğŸ”„ Resetuj do pierwszych daÅ„</button>
      <button class="btn-action btn-save" onclick="zapiszPlan()">ğŸ’¾ Zapisz aktualny plan</button>
      <button class="btn-action btn-load" onclick="toggleSavedPlans()">ğŸ“‚ Wczytaj zapisany plan</button>
    </div>
    
    <div id="savedPlansSection" style="display: none;" class="saved-plans">
      <h3 style="margin-top: 0;">ğŸ“‹ Zapisane plany:</h3>
      <div id="savedPlansList"></div>
    </div>

    <div id="dropdowns"></div>
    <button onclick="generujPlan()" class="btn-primary" style="margin-top: 20px;">ğŸ“‹ PokaÅ¼ jadÅ‚ospis i listÄ™ zakupÃ³w</button>

    <div id="plan"></div>
    
    <div id="zakupy-section" style="display: none;">
      <div class="result-section">
        <h2>ğŸ›’ Opcje listy zakupÃ³w</h2>
        <div class="day-selector">
          <p><strong>Wybierz dni, na ktÃ³re chcesz zrobiÄ‡ zakupy:</strong></p>
          <div class="day-checkboxes">
            <label class="day-checkbox-label">
              <input type="checkbox" class="day-checkbox" value="0" checked>
              PoniedziaÅ‚ek
            </label>
            <label class="day-checkbox-label">
              <input type="checkbox" class="day-checkbox" value="1" checked>
              Wtorek
            </label>
            <label class="day-checkbox-label">
              <input type="checkbox" class="day-checkbox" value="2" checked>
              Åšroda
            </label>
            <label class="day-checkbox-label">
              <input type="checkbox" class="day-checkbox" value="3" checked>
              Czwartek
            </label>
            <label class="day-checkbox-label">
              <input type="checkbox" class="day-checkbox" value="4" checked>
              PiÄ…tek
            </label>
            <label class="day-checkbox-label">
              <input type="checkbox" class="day-checkbox" value="5" checked>
              Sobota
            </label>
            <label class="day-checkbox-label">
              <input type="checkbox" class="day-checkbox" value="6" checked>
              Niedziela
            </label>
          </div>
          <div style="margin-top: 15px;">
            <button class="btn-filter" onclick="filterShoppingList()">ğŸ”„ Aktualizuj listÄ™ zakupÃ³w</button>
            <button class="btn-filter" onclick="selectAllDays(true)">âœ… Zaznacz wszystkie</button>
            <button class="btn-filter" onclick="selectAllDays(false)">âŒ Odznacz wszystkie</button>
          </div>
        </div>
      </div>
    </div>
    
    <div id="zakupy"></div>
  </div>

  <div id="activity-tab" class="tab-content">
    <h2>ğŸƒâ€â™‚ï¸ AktywnoÅ›Ä‡ i Zdrowie</h2>
    
    <!-- Kalkulator spalonych kalorii -->
    <div class="card">
      <h3>ğŸ”¥ Kalkulator spalonych kalorii</h3>
      <div class="form-group">
        <label>Kto trenowaÅ‚?</label>
        <select id="activityPerson">
          <option value="person1"><span class="person-michalina-name">Michalina</span></option>
          <option value="person2"><span class="person-marcin-name">Marcin</span></option>
        </select>
      </div>
      <div class="form-group">
        <label>Waga (kg):</label>
        <input type="number" id="activityWeight" placeholder="np. 70" min="30" max="200">
      </div>
      <div class="form-group">
        <label>Rodzaj aktywnoÅ›ci:</label>
        <select id="activityType">
          <option value="3.8">Spacer powolny (3-4 km/h)</option>
          <option value="4.3">Spacer Å›redni (5-6 km/h)</option>
          <option value="5.0">Spacer szybki (6-7 km/h)</option>
          <option value="7.0">Bieg powolny (8 km/h)</option>
          <option value="10.0">Bieg Å›redni (10 km/h)</option>
          <option value="12.5">Bieg szybki (12+ km/h)</option>
          <option value="6.0">Rower rekreacyjny</option>
          <option value="8.0">Rower intensywny</option>
          <option value="8.0">SiÅ‚ownia (umiarkowana)</option>
          <option value="10.0">SiÅ‚ownia (intensywna)</option>
          <option value="8.0">PÅ‚ywanie rekreacyjne</option>
          <option value="11.0">PÅ‚ywanie intensywne</option>
          <option value="7.0">Joga/Pilates</option>
          <option value="12.0">Crossfit/HIIT</option>
        </select>
      </div>
      <div class="form-group">
        <label>Czas trwania (minuty):</label>
        <input type="number" id="activityDuration" placeholder="np. 45" min="1" max="300">
      </div>
      <button onclick="calculateCalories()" class="btn-primary">ğŸ”¥ Oblicz spalone kalorie</button>
      <div id="caloriesResult" style="margin-top: 15px;"></div>
      <button onclick="saveActivity()" class="btn-success" style="margin-top: 10px; display: none;" id="saveActivityBtn">ğŸ’¾ Zapisz aktywnoÅ›Ä‡</button>
    </div>

    <!-- Dziennik aktywnoÅ›ci -->
    <div class="card">
      <h3>ğŸ“Š Dziennik aktywnoÅ›ci (tydzieÅ„)</h3>
      <div id="activityLog"></div>
      <div id="activitySummary" style="margin-top: 15px;"></div>
    </div>

    <!-- Tracker wagi -->
    <div class="card">
      <h3>âš–ï¸ Dziennik wagi i pomiarÃ³w</h3>
      <div class="form-group">
        <label>Wybierz osobÄ™:</label>
        <select id="weightPerson">
          <option value="person1"><span class="person-michalina-name">Michalina</span></option>
          <option value="person2"><span class="person-marcin-name">Marcin</span></option>
        </select>
      </div>
      <div class="form-group">
        <label>Data:</label>
        <input type="date" id="weightDate">
      </div>
      <div class="form-group">
        <label>Waga (kg):</label>
        <input type="number" id="weightValue" step="0.1" placeholder="np. 72.5">
      </div>
      <button onclick="saveWeight()" class="btn-success">ğŸ’¾ Zapisz wagÄ™</button>
      <div id="weightHistory" style="margin-top: 20px;"></div>
    </div>

    <!-- Tracker wody -->
    <div class="card">
      <h3>ğŸ’§ Tracker wody - dziÅ›</h3>
      <div class="form-group">
        <label>Wybierz osobÄ™:</label>
        <select id="waterPerson">
          <option value="person1"><span class="person-michalina-name">Michalina</span></option>
          <option value="person2"><span class="person-marcin-name">Marcin</span></option>
        </select>
      </div>
      <div class="form-group">
        <label>Cel dzienny (litry):</label>
        <input type="number" id="waterGoal" value="2.5" step="0.1" min="1" max="5">
      </div>
      <div class="water-buttons">
        <button onclick="addWater(0.25)" class="btn-water">+250ml</button>
        <button onclick="addWater(0.5)" class="btn-water">+500ml</button>
        <button onclick="addWater(0.75)" class="btn-water">+750ml</button>
        <button onclick="resetWater()" class="btn-reset-small">ğŸ”„ Reset</button>
      </div>
      <div id="waterProgress" style="margin-top: 20px;"></div>
    </div>

    <!-- Analiza makroskÅ‚adnikÃ³w -->
    <div class="card">
      <h3>ğŸ“Š Analiza makroskÅ‚adnikÃ³w - plan tygodniowy</h3>
      <p style="color: #666; font-style: italic;">Generuj plan tygodniowy w zakÅ‚adce "Planner", aby zobaczyÄ‡ analizÄ™ makroskÅ‚adnikÃ³w</p>
      <div id="macroAnalysis"></div>
    </div>
  </div>

  <div id="fridge-tab" class="tab-content">
    <h2>ğŸ§Š LodÃ³wka i zakupy</h2>
    
    <!-- ZarzÄ…dzanie lodÃ³wkÄ… -->
    <div class="card">
      <h3>ğŸ§Š Co mam w lodÃ³wce?</h3>
      <div class="form-group">
        <label>Dodaj produkt:</label>
        <input type="text" id="fridgeProduct" placeholder="np. Mleko">
      </div>
      <div class="form-group">
        <label>IloÅ›Ä‡ (g/ml/szt):</label>
        <input type="number" id="fridgeAmount" placeholder="np. 1000">
      </div>
      <div class="form-group">
        <label>Jednostka:</label>
        <select id="fridgeUnit">
          <option value="g">gramy (g)</option>
          <option value="ml">mililitry (ml)</option>
          <option value="szt">sztuki (szt)</option>
        </select>
      </div>
      <div class="form-group">
        <label>Data waÅ¼noÅ›ci (opcjonalnie):</label>
        <input type="date" id="fridgeExpiry">
      </div>
      <button onclick="addToFridge()" class="btn-success">â• Dodaj do lodÃ³wki</button>
      <div id="fridgeList" style="margin-top: 20px;"></div>
    </div>

    <!-- Sugestie daÅ„ -->
    <div class="card">
      <h3>ğŸ’¡ Sugestie daÅ„ z dostÄ™pnych produktÃ³w</h3>
      <button onclick="suggestDishes()" class="btn-primary">ğŸ” ZnajdÅº dania</button>
      <div id="dishSuggestions" style="margin-top: 15px;"></div>
    </div>

    <!-- Lista zakupÃ³w z cenami -->
    <div class="card">
      <h3>ğŸ’° ZarzÄ…dzaj cenami produktÃ³w</h3>
      <p style="color: #666; font-style: italic;">Dodaj ceny produktÃ³w, aby szacowaÄ‡ koszt zakupÃ³w</p>
      <div class="form-group">
        <label>Produkt:</label>
        <input type="text" id="priceProduct" placeholder="np. Mleko 2%">
      </div>
      <div class="form-group">
        <label>Cena za 100g/100ml (zÅ‚):</label>
        <input type="number" id="priceValue" step="0.01" placeholder="np. 0.50">
      </div>
      <div class="form-group">
        <label>Sklep:</label>
        <input type="text" id="priceShop" placeholder="np. Biedronka">
      </div>
      <button onclick="savePrice()" class="btn-success">ğŸ’¾ Zapisz cenÄ™</button>
      <div id="priceList" style="margin-top: 20px;"></div>
    </div>

    <!-- Szacowany koszt -->
    <div class="card">
      <h3>ğŸ’µ Szacowany koszt zakupÃ³w</h3>
      <p style="color: #666; font-style: italic;">Generuj listÄ™ zakupÃ³w w zakÅ‚adce "Planner", aby zobaczyÄ‡ szacowany koszt</p>
      <div id="costEstimate"></div>
    </div>
  </div>

  <div id="training-tab" class="tab-content">
    <h2>ğŸ’ª Plan treningowy</h2>
    
    <!-- Planner treningowy -->
    <div class="card">
      <h3>ğŸ“… Plan treningÃ³w na tydzieÅ„</h3>
      <div id="trainingPlanner"></div>
    </div>

    <!-- Dodaj trening -->
    <div class="card">
      <h3>â• Dodaj trening</h3>
      <div class="form-group">
        <label>DzieÅ„ tygodnia:</label>
        <select id="trainingDay">
          <option value="0">PoniedziaÅ‚ek</option>
          <option value="1">Wtorek</option>
          <option value="2">Åšroda</option>
          <option value="3">Czwartek</option>
          <option value="4">PiÄ…tek</option>
          <option value="5">Sobota</option>
          <option value="6">Niedziela</option>
        </select>
      </div>
      <div class="form-group">
        <label>Kto trenuje?</label>
        <select id="trainingPerson">
          <option value="person1"><span class="person-michalina-name">Michalina</span></option>
          <option value="person2"><span class="person-marcin-name">Marcin</span></option>
          <option value="both">Oboje</option>
        </select>
      </div>
      <div class="form-group">
        <label>Rodzaj treningu:</label>
        <select id="trainingType">
          <option value="Cardio">Cardio (bieg, rower, orbitrek)</option>
          <option value="SiÅ‚owy">SiÅ‚owy (FBW, Split)</option>
          <option value="Funkcjonalny">Funkcjonalny (Crossfit, HIIT)</option>
          <option value="RozciÄ…ganie">RozciÄ…ganie/Yoga</option>
          <option value="Sport">Sport (piÅ‚ka, pÅ‚ywanie, itp.)</option>
          <option value="WÅ‚asny">WÅ‚asny</option>
        </select>
      </div>
      <div class="form-group">
        <label>Nazwa/Opis treningu:</label>
        <input type="text" id="trainingName" placeholder="np. Bieg interwaÅ‚owy 5km">
      </div>
      <div class="form-group">
        <label>Czas (minuty):</label>
        <input type="number" id="trainingTime" placeholder="np. 45" min="5">
      </div>
      <button onclick="saveTraining()" class="btn-success">ğŸ’¾ Dodaj trening do planu</button>
    </div>

    <!-- Biblioteka Ä‡wiczeÅ„ -->
    <div class="card">
      <h3>ğŸ“š Biblioteka Ä‡wiczeÅ„</h3>
      <div class="exercise-categories">
        <button onclick="showExercises('chest')" class="btn-exercise">ğŸ’ª Klatka piersiowa</button>
        <button onclick="showExercises('back')" class="btn-exercise">ğŸ‹ï¸ Plecy</button>
        <button onclick="showExercises('legs')" class="btn-exercise">ğŸ¦µ Nogi</button>
        <button onclick="showExercises('arms')" class="btn-exercise">ğŸ’ª Ramiona</button>
        <button onclick="showExercises('core')" class="btn-exercise">ğŸ¯ Brzuch/Core</button>
        <button onclick="showExercises('cardio')" class="btn-exercise">ğŸƒ Cardio</button>
      </div>
      <div id="exerciseList" style="margin-top: 20px;"></div>
    </div>

    <!-- Garmin Connect Integration -->
    <div class="card">
      <h3>âŒš Garmin Connect</h3>
      <p style="color: #666; margin-bottom: 15px;">Importuj dane treningowe z Garmin Connect:</p>
      <div class="garmin-info">
        <div class="info-item">
          <strong>ğŸ“± Aplikacja mobilna:</strong>
          <p>Pobierz aplikacjÄ™ Garmin Connect z App Store lub Google Play</p>
        </div>
        <div class="info-item">
          <strong>ğŸ’» Wersja webowa:</strong>
          <p><a href="https://connect.garmin.com" target="_blank" class="garmin-link">connect.garmin.com</a></p>
        </div>
        <div class="info-item">
          <strong>ğŸ“Š Eksport danych:</strong>
          <p>W Garmin Connect: AktywnoÅ›Ä‡ â†’ Eksportuj do CSV â†’ Skopiuj dane spalonych kalorii</p>
        </div>
      </div>
      <button onclick="window.open('https://connect.garmin.com', '_blank')" class="btn-primary" style="margin-top: 15px;">ğŸ”— OtwÃ³rz Garmin Connect</button>
    </div>
  </div>

  <div id="stats-tab" class="tab-content">
    <h2>ğŸ“Š Statystyki & Historia TreningÃ³w</h2>

    <div class="card">
      <h3>ğŸ“ Import danych Garmin Connect (CSV)</h3>
      <p style="color: #666; margin-bottom: 15px;">Importuj dane treningowe z Garmin Connect dla kaÅ¼dej osoby osobno. Plik CSV powinien zawieraÄ‡ kolumny: Data, AktywnoÅ›Ä‡, Czas, Dystans, Kalorie.</p>
      
      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
        <div class="import-section">
          <h4><span class="person-michalina-name">Michalina</span></h4>
          <input type="file" id="csvFilePerson1" accept=".csv" style="display: none;" onchange="handleCSVUpload(1)">
          <button onclick="document.getElementById('csvFilePerson1').click()" class="btn-primary">ğŸ“¤ Wybierz plik CSV</button>
          <div id="csvStatus1" style="margin-top: 10px; font-size: 14px; color: #666;"></div>
        </div>
        
        <div class="import-section">
          <h4><span class="person-marcin-name">Marcin</span></h4>
          <input type="file" id="csvFilePerson2" accept=".csv" style="display: none;" onchange="handleCSVUpload(2)">
          <button onclick="document.getElementById('csvFilePerson2').click()" class="btn-primary">ğŸ“¤ Wybierz plik CSV</button>
          <div id="csvStatus2" style="margin-top: 10px; font-size: 14px; color: #666;"></div>
        </div>
      </div>

      <div style="background: #f0f7ff; padding: 15px; border-radius: 8px; border: 1px solid #007AFF;">
        <strong>ğŸ’¡ Jak pobraÄ‡ dane z Garmin Connect:</strong>
        <ol style="margin: 10px 0 0 20px; line-height: 1.8;">
          <li>Zaloguj siÄ™ do <a href="https://connect.garmin.com" target="_blank" style="color: #007AFF;">connect.garmin.com</a></li>
          <li>PrzejdÅº do: AktywnoÅ›ci â†’ Wszystkie aktywnoÅ›ci</li>
          <li>Kliknij "Eksportuj" â†’ "Eksportuj do CSV"</li>
          <li>Wybierz zakres dat i pobierz plik</li>
          <li>Zaimportuj plik powyÅ¼ej</li>
        </ol>
      </div>
    </div>

    <div class="card">
      <h3>ğŸ“ˆ Podsumowanie</h3>
      <div id="statsSummary" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
        <div style="background: #f0f7ff; padding: 15px; border-radius: 8px; text-align: center;">
          <div style="font-size: 32px; font-weight: bold; color: #007AFF;" id="totalWorkouts">0</div>
          <div style="color: #666; margin-top: 5px;">Treningi</div>
        </div>
        <div style="background: #fff3e0; padding: 15px; border-radius: 8px; text-align: center;">
          <div style="font-size: 32px; font-weight: bold; color: #FF9500;" id="totalCalories">0</div>
          <div style="color: #666; margin-top: 5px;">Kalorie</div>
        </div>
        <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; text-align: center;">
          <div style="font-size: 32px; font-weight: bold; color: #34C759;" id="totalDistance">0</div>
          <div style="color: #666; margin-top: 5px;">km</div>
        </div>
        <div style="background: #fce4ec; padding: 15px; border-radius: 8px; text-align: center;">
          <div style="font-size: 32px; font-weight: bold; color: #FF2D55;" id="totalTime">0</div>
          <div style="color: #666; margin-top: 5px;">Godziny</div>
        </div>
      </div>
    </div>

    <div class="card">
      <h3>ğŸ” Filtry</h3>
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
        <div class="form-group">
          <label>Osoba:</label>
          <select id="filterPerson" onchange="filterTrainingHistory()">
            <option value="all">Wszyscy</option>
            <option value="1"><span class="person-michalina-name">Michalina</span></option>
            <option value="2"><span class="person-marcin-name">Marcin</span></option>
          </select>
        </div>
        <div class="form-group">
          <label>Typ aktywnoÅ›ci:</label>
          <select id="filterActivity" onchange="filterTrainingHistory()">
            <option value="all">Wszystkie</option>
          </select>
        </div>
        <div class="form-group">
          <label>Od daty:</label>
          <input type="date" id="filterDateFrom" onchange="filterTrainingHistory()">
        </div>
        <div class="form-group">
          <label>Do daty:</label>
          <input type="date" id="filterDateTo" onchange="filterTrainingHistory()">
        </div>
      </div>
      <button onclick="resetFilters()" class="btn-action">ğŸ”„ Reset filtrÃ³w</button>
    </div>

    <div class="card">
      <h3>ğŸ“‹ Historia treningÃ³w</h3>
      <div id="trainingHistoryList"></div>
    </div>

    <div class="card">
      <h3>ğŸ“Š Wykres - Kalorie w czasie</h3>
      <canvas id="caloriesChart" style="width: 100%; height: 300px;"></canvas>
    </div>

    <div class="card">
      <button onclick="exportTrainingData()" class="btn-success">ğŸ’¾ Eksportuj wszystkie dane do CSV</button>
      <button onclick="clearAllTrainingData()" class="btn-action" style="margin-left: 10px;">ğŸ—‘ï¸ WyczyÅ›Ä‡ wszystkie dane</button>
    </div>
  </div>

  <div id="manage-tab" class="tab-content">
    <h2>âš™ï¸ ZarzÄ…dzaj danymi</h2>
    
    <div class="firebase-sync-section">
      <h3 style="margin-top: 0;">â˜ï¸ Synchronizacja miÄ™dzy urzÄ…dzeniami</h3>
      <p style="margin: 10px 0; opacity: 0.95;">WÅ‚Ä…cz synchronizacjÄ™, aby automatycznie przenosiÄ‡ dane miÄ™dzy Mac, iPhone i innymi urzÄ…dzeniami.</p>
      <div id="syncSection">
        <div id="syncDisabled">
          <p style="margin: 10px 0; font-size: 14px; opacity: 0.9;">âœ… JadÅ‚ospis i lista zakupÃ³w - dziaÅ‚a lokalnie (bez synchronizacji)<br>ğŸ“Š Historia treningÃ³w, wagi, Garmin - moÅ¼na zsynchronizowaÄ‡</p>
          <button onclick="showFirebaseLogin()" style="background: white; color: #667eea; padding: 12px 24px; border: none; border-radius: 8px; font-size: 16px; cursor: pointer; font-weight: bold; margin-top: 10px; box-shadow: 0 2px 8px rgba(0,0,0,0.15);">ğŸ”— WÅ‚Ä…cz synchronizacjÄ™ (opcjonalnie)</button>
        </div>
        <div id="syncEnabled" style="display: none;">
          <p style="margin: 10px 0;">âœ… Synchronizacja wÅ‚Ä…czona</p>
          <div style="display: flex; gap: 10px; align-items: center; margin-top: 15px;">
            <img id="syncUserPhoto" src="" alt="" style="width: 40px; height: 40px; border-radius: 50%; border: 2px solid white;">
            <div style="flex: 1;">
              <div id="syncUserName" style="font-weight: bold;">UÅ¼ytkownik</div>
              <div id="syncUserEmail" style="font-size: 12px; opacity: 0.8;">email@example.com</div>
            </div>
            <button id="disableSyncBtn" style="background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.3); color: white !important; padding: 8px 16px; border-radius: 6px; cursor: pointer;">Wyloguj</button>
          </div>
        </div>
      </div>
    </div>
    
    <div style="background: #f0f7ff; padding: 20px; border-radius: 8px; border: 2px solid #2196f3; margin-bottom: 20px;">
      <h3 style="color: #1d1d1f;">ğŸ‘¤ Edytuj imiona uÅ¼ytkownikÃ³w</h3>
      <div class="form-group">
        <label style="color: #1d1d1f;">Osoba 1 (aktualnie: <span class="person-michalina-name">Michalina</span>):</label>
        <input type="text" id="namePerson1" placeholder="np. Anna, Kasia, Ewa..." value="Michalina">
      </div>
      <div class="form-group">
        <label style="color: #1d1d1f;">Osoba 2 (aktualnie: <span class="person-marcin-name">Marcin</span>):</label>
        <input type="text" id="namePerson2" placeholder="np. Jan, Piotr, MichaÅ‚..." value="Marcin">
      </div>
      <button onclick="updateNames()" style="width: 100%; background: #2196f3; color: white; padding: 12px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; font-weight: bold;">âœ… Zapisz imiona</button>
      <small style="color: #666; display: block; margin-top: 10px;">ğŸ’¡ Imiona bÄ™dÄ… widoczne w caÅ‚ej aplikacji: planner, lista zakupÃ³w, eksport</small>
    </div>
    
    <div style="background: #fff; padding: 20px; border-radius: 8px; border: 2px solid #ddd; margin-bottom: 20px;">
      <h3 style="color: #1d1d1f;">â• Dodaj nowe danie</h3>
      <div class="form-group">
        <label>Typ posiÅ‚ku:</label>
        <select id="newDishType" style="width: 100%;">
          <option value="Å›niadanie">Åšniadanie</option>
          <option value="obiad">Obiad</option>
          <option value="kolacja">Kolacja</option>
          <option value="podwieczorek">Podwieczorek</option>
        </select>
      </div>
      <div class="form-group">
        <label>Nazwa dania:</label>
        <input type="text" id="newDishName" placeholder="np. Owsianka z owocami">
      </div>
      <div class="form-group">
        <label>Przepis (opcjonalnie):</label>
        <textarea id="newDishRecipe" placeholder="Wpisz przepis krok po kroku..."></textarea>
      </div>
      <div class="form-group">
        <label>Kalorie bazowe (dla Osoba 1 - 1300 kcal):</label>
        <input type="number" id="newDishCalories" placeholder="np. 350" min="0">
        <small style="color: #666; display: block; margin-top: 4px;">ğŸ’¡ Kalorie bÄ™dÄ… automatycznie skalowane wedÅ‚ug wybranego celu kalorycznego</small>
      </div>
      <div class="form-group">
        <label>SkÅ‚adniki (JSON format): [Produkt, gramatura Osoba 1, gramatura Osoba 2]</label>
        <textarea id="newDishIngredients" placeholder="{
  'PÅ‚atki owsiane': [40, 70],
  'Mleko 2%': [120, 200],
  'Banan': [60, 100]
}"></textarea>
      </div>
      <button onclick="addNewDish()" style="width: 100%; background: #28a745; color: white; padding: 12px; border: none; border-radius: 5px; font-size: 16px; cursor: pointer; font-weight: bold;">âœ… Dodaj danie</button>
    </div>

    <h3 style="color: #1d1d1f;">ğŸ“‹ Lista wszystkich daÅ„</h3>
    <div id="dishList" class="dish-list"></div>
  </div>
</div>

<!-- Firebase SDK -->
<script type="module">
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
  import { getAuth, signInWithPopup, GoogleAuthProvider, signOut, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
  import { getFirestore, doc, setDoc, getDoc, updateDoc, deleteDoc, collection, query, getDocs, enableIndexedDbPersistence } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
  
  // Firebase configuration - ZASTÄ„P SWOIMI DANYMI po utworzeniu projektu Firebase
  // JeÅ›li nie chcesz uÅ¼ywaÄ‡ Firebase, zostaw puste - aplikacja bÄ™dzie dziaÅ‚aÄ‡ lokalnie
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
    projectId: "YOUR_PROJECT_ID",
    storageBucket: "YOUR_PROJECT_ID.appspot.com",
    messagingSenderId: "YOUR_SENDER_ID",
    appId: "YOUR_APP_ID"
  };
  
  // Initialize Firebase only if config is valid
  if (firebaseConfig.apiKey !== "YOUR_API_KEY") {
    try {
      const app = initializeApp(firebaseConfig);
      const auth = getAuth(app);
      const db = getFirestore(app);
      
      // Enable offline persistence
      enableIndexedDbPersistence(db).catch((err) => {
        if (err.code == 'failed-precondition') {
          console.warn('Offline persistence: Multiple tabs open');
        } else if (err.code == 'unimplemented') {
          console.warn('Offline persistence: Browser not supported');
        }
      });
      
      // Export to window for use in other scripts
      window.firebaseAuth = auth;
      window.firebaseDb = db;
      window.firebaseSignIn = signInWithPopup;
      window.firebaseSignOut = signOut;
      window.firebaseAuthChanged = onAuthStateChanged;
      window.GoogleAuthProvider = GoogleAuthProvider;
      window.firestoreDoc = doc;
      window.firestoreSetDoc = setDoc;
      window.firestoreGetDoc = getDoc;
      window.firestoreUpdateDoc = updateDoc;
      window.firestoreDeleteDoc = deleteDoc;
      window.firestoreCollection = collection;
      window.firestoreQuery = query;
      window.firestoreGetDocs = getDocs;
      
      console.log('âœ… Firebase initialized');
    } catch (error) {
      console.warn('âš ï¸ Firebase nie zainicjalizowany (dziaÅ‚amy lokalnie):', error.message);
    }
  } else {
    console.log('â„¹ï¸ Firebase config not set - running in local mode');
  }
</script>

<script src="data.js"></script>
<script src="script.js"></script>
</body>
</html>
